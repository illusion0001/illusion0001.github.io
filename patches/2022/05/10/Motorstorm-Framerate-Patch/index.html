<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>illusion's Blog | Patches and Improvements for MotorStorm Titles (RPCS3)</title>
  
  <link rel="stylesheet" href="/assets/css/main.css" />
  <link rel="stylesheet" href="/assets/css/post.css" />
  <link rel="stylesheet" href="/assets/css/syntax.css" />
  
  <link rel="stylesheet" href="/assets/css/common.css" />
  <script src="/assets/js/categories.js"></script>
  
  <script defer src="/assets/js/lbox.js"></script>
  
  <!-- Twemoji -->
  <!-- src https://github.com/SebastianAigner/twemoji-amazing -->
  <link rel="stylesheet" href="/assets/css/twemoji-amazing.css">
</head>

  <body>
    <main class="blogfeed">
      
<header>
  <a class="site-title article-page" href="/">illusion's Blog</a>
</header>




      <section id="social-links1">
  
    <a href="/contact" target="_blank"> Contact</a>
  
    <a href="/patch" target="_blank"> Patches</a>
  
</section>

<section id="social-links">

  <a href="https://github.com/illusion0001" target="_blank">
    <img src="/assets/icons/github.svg" alt="" />
  </a>

  <a href="mailto:illusion3185@gmail.com" target="_blank">
    <img src="/assets/icons/email.svg" alt="" />
  </a>

</section>

      <section id="article">
        
        <!--  -->
        
        <!--  -->
        
        
        <div
          class="article-thumbnail"
          style="
            background-image: url('https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/cover-thumbnail-ms3.png');
          "
        >
        
          <h1 class="article-title">Patches and Improvements for MotorStorm Titles (RPCS3)</h1>
          <div class="article-bottom">
            <small class="article-date">10 May 2022</small>
            <div class="article-categories">
              
              <a href="#!" class="article-category">patches</a>
              
            </div>
          </div>
        </div>
        <div class="article-content"><p>A beloved classic franchise from Evolution Studios. Where we race against AI and online opponents in muddy race tracks with big trucks, sounds exciting? Because it is!</p>

<h2 id="original-experience">Original Experience</h2>

<p>Motorstorm Titles on PS3 ran at a wobbly 30FPS, 720p with dynamic resolution scaling, that’s right the game has DRS, all the way back in 2006.</p>

<p>Low sample motion blur, although it looks fine at it’s original resolution and framerate but it does not hold up particularly well at high resolution and framerates and at first sight, fixed timestep. <i class="twa-2x kat-angry"></i></p>

<h2 id="hidden-gems---part-1-framerate-modes">Hidden Gems - Part 1 (Framerate Modes)</h2>

<p>Running the game on the RPCS3 emulator with increased vblank shows disappointing results. sped up gameplay.</p>

<div align="center">
<video width="100%" controls="" muted="" loop="">
  <source src="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/video-ms1-no-delta-30fps-target.mp4" type="video/mp4" />
</video>
</div>

<div align="center">
<em> Look at it go! The game is so fast it might hurt. </em>
</div>

<p>The hidden gem here is game speed. When you crash your vehicle, the game slows down to 0.125f. And normal gameplay it’s 1.00f. peeking at this area shows some curious values.</p>

<p><code class="language-plaintext highlighter-rouge">3F 80 00 00 00 00 00 02 00 00 00 00 01</code></p>

<p>Setting the byte 2 to 1 gives us..</p>

<div align="center">
<video width="100%" controls="" muted="" loop="">
  <source src="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/video-ms1-no-delta-60fps-target.mp4" type="video/mp4" />
</video>
</div>

<p>60FPS Gameplay? Alright, that’s cool but it’s still fixed timestep and double speed at 120FPS.</p>

<p>Not shippable if you ask me.</p>

<p>Let’s pay a little more attention to what’s <em>down below</em>, what happens if I set this next int32 to 1… <i class="twa-2x kat-smug"></i></p>

<div align="center">
<video width="100%" controls="" muted="" loop="">
  <source src="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/video-ms1-delta-120fps.mp4" type="video/mp4" />
</video>
</div>

<div align="center">
<em> Is that Deltatime? </em>
</div>

<p>I apologize if that clip made you all jelly. It did for me seeing it for the first time as well.</p>

<p>The same memory pattern exists in other games all the way to Motorstorm RC.</p>

<p>As for the names, the files were left bare within MotorStorm: Pacific Rift.</p>

<div class="language-lua highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- globalparams.lua: auto-generated by GoStorm2 at 17/07/2007 14:28:25</span>
<span class="n">FrameRateMode</span><span class="p">(</span><span class="s2">"30Hz Lock"</span><span class="p">)</span>
<span class="c1">-- Possible values:</span>
<span class="c1">-- See game_config.xml for more info.</span>
<span class="c1">-- 30Hz Lock    -- 30 FPS    (No Havok Deltatime) -- Default for all games.</span>
<span class="c1">-- 60Hz Lock    -- 60 FPS    (No Havok Deltatime)</span>
<span class="c1">-- Compensation -- Deltatime (Use Havok Deltatime)</span>
</code></pre></div></div>

<h2 id="blur-blurryness-everywhere---part-2-dynamic-resolution-scaling">Blur, Blurryness Everywhere - Part 2 (Dynamic Resolution Scaling)</h2>

<p>Two things stood out to me when I played this with the unlocked framerate, the image can become blurry out of nowhere and the motion blur doesn’t look as good.</p>

<p>Let’s start with the most obvious image quality flaw, dynamic resolution scaling. The game scales the resolution based on frametime targets, if it is below its threshold of 33.3ms, the game drops its resolution to 360p at it’s lowest, to find it? 720p during the clearest moments and <code class="language-plaintext highlighter-rouge">Decreased Values</code> when things get blurry.</p>

<div align="center" class="">
  <a href="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen_MS1-3.png">
  <img src="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen_MS1-3.png" />
</a></div>

<div align="center" class="">
  <a href="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen_MS1-4.png">
  <img src="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen_MS1-4.png" />
</a></div>

<p>I narrowed it down to this subroutine (<code class="language-plaintext highlighter-rouge">0x002634c8</code>) with a compare float statement and all I have to do is to skip this operation, simple.</p>

<h2 id="blur-blurryness-everywhere---part-3-motion-blur">Blur, Blurryness Everywhere - Part 3 (Motion Blur)</h2>

<p>Peeking at the game executable and searching for Blur, I got a few results. <code class="language-plaintext highlighter-rouge">WorldMotionBlurBase</code> <code class="language-plaintext highlighter-rouge">BlurAccel</code> and <code class="language-plaintext highlighter-rouge">BlurDecel</code>. This smells like some sort of configuration key. Let’s try memory.</p>

<div align="center" class="">
  <a href="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen_MS1-5.png">
  <img src="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen_MS1-5.png" />
</a></div>

<div align="center">
<em> Oh, what's that? Game settings? </em>
</div>

<details>
<summary>advancedsettings.lua (Click to Expand)</summary>


<figure class="highlight"><pre><code class="language-lua" data-lang="lua"><span class="c1">-- Taken from NPEA90006/NPEA80017 1.01 at address 0x300767ba</span>

<span class="c1">-- Begin original file:</span>
<span class="c1">-- advancedsettings.lua: auto-generated by GoStorm2 at 28/02/2007 10:28 am</span>
<span class="n">WorldMotionBlurBase</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">55</span><span class="p">)</span>
<span class="n">CarMotionBlurBase</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">43</span><span class="p">)</span>
<span class="n">BoostBlurEnabled</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="n">BlurAccel</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="p">)</span>
<span class="n">BlurDecel</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="p">)</span>
<span class="n">WorldBlurMax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">CarBlurMax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ParticleEmissionRate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">VehicleDamageRate</span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">81</span><span class="p">)</span></code></pre></figure>


</details>

<div align="center" class="">
  <a href="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen_MS1-6.png">
  <img src="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen_MS1-6.png" />
</a></div>

<p>Setting these to 0.0f gets rid of the motion blur and it looks good!</p>

<div align="center">
<video width="100%" controls="" muted="" loop="">
  <source src="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/video-ms1-no-blur.mp4" type="video/mp4" />
</video>
</div>

<h2 id="blur-blurryness-everywhere---part-4-porting-to-newer-games">Blur, Blurryness Everywhere - Part 4 (Porting to Newer Games)</h2>

<p>Get ready because the things we learned in the past two sections of this post is going to be thrown out the window, Starting with Motorstorm Pacific Rift, they changed the settings to use the XML format and the code being much easier to read.</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Motorstorm RC for demonstration, similar code is used in Pacific Rift and Apocalypse.</span>
<span class="c1">// at 0x001a8050 for NPUA80678 01.02</span>
<span class="n">ParseFile</span><span class="p">(</span><span class="s">"scripts/viewportquality.xml"</span><span class="p">);</span>
<span class="c1">// -- snip --</span>
<span class="n">GetSectionKeyName</span>       <span class="o">=</span> <span class="n">ParseSectionKey</span><span class="p">(</span><span class="s">"General"</span><span class="p">);</span>
<span class="kt">bool</span> <span class="n">GetBoolValFromFile</span> <span class="o">=</span> <span class="n">ParseValueKey</span><span class="p">(</span><span class="s">"enableMotionBlur"</span><span class="p">);</span>
<span class="c1">// &lt;General enableMotionBlur="true"/&gt;</span>
<span class="n">enableMotionBlur</span> <span class="o">=</span> <span class="n">GetValFromFile</span><span class="p">;</span>
</code></pre></div></div>

<p>Take <code class="language-plaintext highlighter-rouge">enableMotionBlur</code> for example, the game code looks for this key in a file named <code class="language-plaintext highlighter-rouge">viewportquality.xml</code> within the <code class="language-plaintext highlighter-rouge">scripts</code> folder and reads this value, and since this may change depending on user tweaks, let’s always load this variable using the load intermediate instruction.</p>

<p>The same can be done for <code class="language-plaintext highlighter-rouge">variableScaling</code> (Dynamic Resolution Scaling)</p>

<p>Comparison Images:</p>

<div align="center">
<em> Before: </em>
</div>

<div align="center" class="">
  <a href="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen-MS2-0.png">
  <img src="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen-MS2-0.png" />
</a></div>

<div align="center">
<em> After: </em>
</div>

<div align="center" class="">
  <a href="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen-MS2-1.png">
  <img src="https://img-assets.illusion0001.workers.dev/assets/images/Motorstorm-Framerate-Patch/Screen-MS2-1.png" />
</a></div>

<div align="center">
<em> Checkout how crisp that image looks! Very clear and clean of blur. </em>
</div>

<div align="center">
<video width="100%" controls="" autoplay="" muted="" loop="">
  <source src="https://img-assets.illusion0001.workers.dev/assets/misc/youtube/GravityDazeOverture-Kat-Happy.mp4" type="video/mp4" />
</video>
</div>

<div align="center">
<em> <a href="https://youtu.be/tFeXtu-3u78?t=70">Gravity Rush: The Animation - Overture | Parts A &amp; B</a> </em>
</div>

<p>I won’t lie, this is actually me when I figured out that hidden deltatime feature in these games.</p>

<p>I have already covered MLAA in a <a href="/patches/2021/02/11/ms3-mlaa/">previous post</a> of mine for Motorstorm Apocalypse so if you are interested, check it out!</p>

<h2 id="closing-words">Closing Words</h2>

<p>That’s going to be it for this post, if you like it be sure to share this with others and let them know that if they have a powerful PC, high framerate Motorstorm is a reality, enjoy your enhanced video games!</p>

<p>Oh and one more thing, I wished we got a remaster for these games on the current platform, would be interesting to see how that plays out. Yes, including Driveclub and my beloved Gravity Rush (Gravity Daze) 2</p>

<div align="center" class="">
  <a href="https://img-assets.illusion0001.workers.dev/assets/images/memes/capture/screen-console-ports-meme.png">
  <img src="https://img-assets.illusion0001.workers.dev/assets/images/memes/capture/screen-console-ports-meme.png" />
</a></div>

<div align="center">
<em> <a href="https://youtu.be/tFeXtu-3u78?t=485">Gravity Rush: The Animation - Overture | Parts A &amp; B</a> </em>
</div>

<p>Ah well, I guess emulation will do just fine on our computers.</p>

<h2 id="showcase">Showcase</h2>

<iframe width="560" height="315" src="https://www.youtube.com/embed/-AszzQQ7RI0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<h2 id="patch">Patch</h2>

<p>For those looking to use the patch on the emulator, you can head over to the patch manager, click on the “Download Latest Patches” and find the patch you wanted to use with your game Title ID and version, click on the checkbox to enable the patch and save changes.</p>

<div align="center" class="">
  <a href="https://img-assets.illusion0001.workers.dev/assets/images/RatchetPS3-FPSUnlock/rpcs3_patch_example.png">
  <img src="https://img-assets.illusion0001.workers.dev/assets/images/RatchetPS3-FPSUnlock/rpcs3_patch_example.png" />
</a></div>

<h2 id="supporters">Supporters</h2>

<p>Thanks to the patrons who supported me on various platforms! You guys are awesome!</p>

<h3 id="monthly-supporters">Monthly supporters:</h3>
<ul>
  <li>
    <p><a href="https://www.patreon.com/illusion0001">Patreon</a>:</p>

    <ul>
      <li>ac2pic</li>
      <li>Alexa</li>
      <li>Brett</li>
      <li>Ciril</li>
      <li>GarnetSunset</li>
      <li>Mmmmmhno</li>
      <li>Paul</li>
      <li>PlayStation5Mods</li>
      <li>RazzySxPB</li>
      <li>Ryan</li>
      <li>Voredy</li>
      <li>YveltalGriffin</li>
      <li>Zackery</li>
      <li>alessaro92</li>
      <li>ashenC</li>
      <li>embee</li>
      <li>erdosadam24</li>
      <li>faith</li>
      <li>maplemiyazaki</li>
      <li>patrick</li>
      <li>rudi</li>
    </ul>
  </li>
  <li>
    <p><a href="https://github.com/sponsors/illusion0001">Github Sponsors</a>:</p>

    <ul>
      <li>VIPO777</li>
      <li>WardFail</li>
      <li>Whitehawkx</li>
      <li>gorshco</li>
      <li>jrson83</li>
      <li>regal.</li>
      <li>suwagawaki</li>
    </ul>
  </li>
</ul>

</div>
      </section>
      <footer>
  <p>&copy; 2021 - 2025 | illusion's Blog</br>Theme <a href="https://github.com/sharadcodes/jekyll-theme-material-you"> Jekyll Theme Material You</a></p>
</footer>

    </main>
    <section id="category-modal-bg"></section>
<section id="category-modal">
  <h1 id="category-modal-title"></h1>
  <section id="category-modal-content"></section>
</section>

  </body>
</html>
